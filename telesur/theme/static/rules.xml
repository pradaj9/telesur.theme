<rules
    xmlns="http://namespaces.plone.org/diazo"
    xmlns:css="http://namespaces.plone.org/diazo/css"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xi="http://www.w3.org/2001/XInclude">

    <notheme if="$ajax_load"/>
    <rules css:if-content="#visual-portal-wrapper">

        <xi:include href="common_rules.xml" />
        <xi:include href="home_rules.xml" />
        <xi:include href="seccion_rules.xml" />
        <xi:include href="nota_rules.xml" />
        <xi:include href="programs.xml" />        

        <replace css:theme="div.telesur-right-sidebar #mapa-interactivo">
            <div id="ultimas-noticias">
                <div class="breadcumb-categoria">Ãšltimas Noticias</div>
                <div class="ultima-noticia">
                    <xsl:for-each css:select="dl.portlet-collection-ultimas-noticias dd.portletItem">
                        <xsl:copy-of select="a" /> 
                    </xsl:for-each>
                </div>
            </div>
        </replace>

        <theme href="nota.html" />

        <!-- EDIT views -->
        <rules css:if-content="body.template-edit,
                               body[class*='template-collective.nitf.content'],
                               body.template-atct_edit,
                               body[class*='template-collective.polls.poll'],
                               .template-default_error_message">
                <replace
                    css:theme-children="#telesur-seccion-main"
                    css:content="#portal-column-content" />
                <drop css-if-theme="#scroller-seccion" css:theme="#scroller-seccion" />
                <drop css-if-theme=".telesur-full-column" css:theme=".telesur-full-column" />                 
        </rules>
        <rules css:if-content="body.portaltype-plone-site:not(.template-manage-content-rules),
                               body.template-login_success,
                               body.template-folder_rename_form,
                               body.template-telesur_helper,
                               .template-default_error_message">
            <replace css:theme-children="#telesur-middle"
                css:content="#content" />
        </rules>
<!-- template-collective.polls.poll portaltype-folder section-encuestas
template-collective.polls.poll portaltype-plone-site
template-view portaltype-collective-polls-poll section-encuesta-test
template-edit portaltype-collective-polls-poll section-encuesta-test -->
        <drop css:theme="#telesur-left-content p" />
        <before css:theme=".edittools-placeholder"
            css:content="#edit-bar" />
        <replace css:theme="#telesur-left-content #content-wrapper > h1"
            css:content="#portal-column-content h1.documentFirstHeading" />
        <after css:theme="#telesur-left-content #autor-temp"
            css:content="#parent-fieldname-text" />
        <!--
        <before css:theme="#telesur-left-content #compartir"
            css:content="div.documentContributors" />
            -->
        <replace css:theme="#telesur-left-content div#notas-relacionadas ul"
            css:content="#related-items span" />
        <drop if-content="not(//*[@id='related-items']/span)"
            css:theme="#notas-relacionadas" />
        <drop css:theme="#telesur-left-content div.comentario-individual" />
        <!--
        <after css:theme="#telesur-left-content #comentarios-nota > h2"
            css:content="#viewlet-below-content div.discusion" />
        -->
        <replace css:theme="#ultimos-videos">
            <xsl:copy-of css:select="dl.portlet-static-ultimos-videos > dd > p" />
        </replace>
        <replace css:theme="#ultimos-programas">
            <xsl:copy-of css:select="dl.portlet-static-ultimos-programas > dd > p" />
        </replace>
        <replace
            css:theme="#caja-titulares"
            css:content="#caja-titulares" />

        <!-- if we are authenticated, then don't show comments, special, or the footer -->
        <rules if-content="not(//*[@id='anon-personalbar'])">
          <drop css:if-theme="#especiales" css:theme="#especiales"/>
          <drop css:if-theme=".footer" css:theme=".footer"/>
          <drop css:if-theme="#compartir" css:theme="#compartir"/>
          <drop css:if-theme="#comentarios-nota" css:theme="#comentarios-nota"/>
        </rules>
        <!-- if we are in some of these content types, then show the content of the content type in
        the content area of the diazo theme -->
        <rules css:if-content=".portaltype-link, 
                               .portaltype-collective-polls-poll,
                               .portaltype-image,
                               .portaltype-file">
            <replace css:theme-children="#content-wrapper"
                css:content-children="#content" />
        </rules>
    </rules>
</rules>
