<rules
    xmlns="http://namespaces.plone.org/diazo"
    xmlns:css="http://namespaces.plone.org/diazo/css"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xi="http://www.w3.org/2001/XInclude">

    <rules css:if-content="body.portaltype-collective-nitf-content">
        <theme href="nota.html" />
        <rules>
            <replace theme="//*[@id='telesur-left-content']/object"
                css:content=".nitf-content-listing div.video-widget.principal" />
            <replace css:theme-children="#telesur-left-content > div.breadcumb-categoria"
                css:content-children="#content-core > div.breadcumb" />
            <drop css:content=".portlet-collection-ultimas-noticias .portletItem a img" />                            
            <after theme="//*[@id='telesur-right-sidebar']/div[1]">
                <div id="ultimas-noticias" class="widget-container">
                    <div class="breadcumb-categoria widget-title">Ãšltimas Noticias</div>
                    <div class="ultima-noticia">
                        <xsl:for-each css:select="dl.portlet-collection-ultimas-noticias dd.portletItem">
                            <xsl:copy-of select="a" /> 
                        </xsl:for-each>
                    </div>
                </div>
            </after>
            <!-- author -->
            <!--<replace css:theme-children="#telesur-left-content #byline" 
              css:content-children="#content p.nitfByline" /> -->
          <!-- colaboradores -->
          <replace css:theme-children="#colabs" 
              css:content-children="#content .documentContributors" />


            <rules css:if-content="#content #media-container">
                <!-- nota counters (video, comments, images, audio)-->
                <replace 
                    css:theme="#media-counter #nota-detail"
                    css:content-children="#content #media-counter" />
                <!-- image gallery code -->
                <after css:theme="#telesur-left-content #media-container"
                    css:content="#content div.newsview" />
                
                <!-- media data, principal video or image -->
                <replace 
                    css:theme-children="#telesur-left-content #media-data"
                    css:content="#content .video-widget.principal" />

                <!-- if videos, then copy those to a gallery div -->
                <replace css:if-content=".nitf-content-listing .video-widget"
                    css:theme-children="#video-galery-container .scrollable-video-galery"
                    css:content=".nitf-content-listing .video-widget.not-principal" />

                <!-- nota description -->
                <replace css:if-content="#content .article-description" 
                    css:theme-children="#telesur-left-content .article-description"
                    css:content="#content .article-description"
                    method="raw" />
                <drop css:content="#content .article-description" />
            </rules>
            
            <!-- upload videos widget -->
            <rules css:if-content="#form-widgets-IAddableVideos-relatedVideos-autocomplete">
                <after css:theme="#media-container" css:content=".contenttreeWindow" />
                <after css:theme="#media-container" css:content="#form-widgets-IAddableVideos-relatedVideos-autocomplete ~ script" />                
            </rules>
        </rules>
        <!-- only load discus IF the user is not anon XXX maybe better in a diazo property in the manifest.cfg? =) -->
        <rules if-content="//*[@id='anon-personalbar']">
          <after css:theme="#telesur-left-content #comentarios-nota > h2">
              <div id="disqus_thread"></div>
              <script type="text/javascript">
                  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                  var disqus_shortname = 'telesurtesting'; // required: replace example with your forum shortname
                  var disqus_developer = 1;
                  /* var disqus_identifier= 'c4a07a5b-676b-419b-9c99-eb0123e48bf2'; */

                  /* * * DON'T EDIT BELOW THIS LINE * * */
                  (function() {
                      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                      
                      var s = document.createElement('script'); s.async = true;
                      s.type = 'text/javascript';
                      s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
                      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
                  })();

              </script>
              <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
              <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
          </after>
        </rules>

        <rules css:if-content="body:not([class*='template-nota'])">
            <replace css:if-content="body.template-edit,
                                     body.template-atct_edit"
                css:theme-children="#telesur-middle #telesur-left-content"
                css:content-children="#portal-column-content" />
            <replace 
                css:theme-children="#telesur-middle #telesur-left-content"
                css:content="#portal-column-content div.documentEditable" />
        </rules>
        <!-- <drop css:content="#edit-bar" /> -->
        <merge attributes="href" css:theme="a#nota-destacada-button"
            css:content="a#nota_destacada"/>
        <replace  css:theme-children="a#nota-destacada-button"
                css:content-children="a#nota_destacada"/>
        <merge attributes="href" css:theme="a#nota-principal-button"
                  css:content="a#nota_principal" />
        <replace css:theme-children="a#nota-principal-button"
                css:content-children="a#nota_principal" />
        <merge attributes="href" css:theme="a#nota-secundaria-button"
                        css:content="a#nota_secundaria" />
        <replace css:theme-children="a#nota-secundaria-button"
                css:content-children="a#nota_secundaria" />
        <merge attributes="href" css:theme="a#nota-seccion-button"
                          css:content="a#nota_seccion" />
        <replace css:theme-children="a#nota-seccion-button"
                  css:content-children="a#nota_seccion" />
        <merge attributes="href" css:theme="a#subir-archivo"
                            css:content="a#file" />
        <replace css:theme-children="a#subir-archivo"
                      css:content-children="a#file" />
        <merge attributes="href" css:theme="a#subir-enlace"
                        css:content="a#link" />
        <replace css:theme-children="a#subir-enlace"
                          css:content-children="a#link" />
        <merge attributes="href" css:theme="a#subir-imagen"
                          css:content="a#image" />
        <replace css:theme-children="a#subir-imagen"
                          css:content-children="a#image" />
        <merge attributes="href" css:theme="a#subir-video"
                                            css:content="li a#multiplefiles" />
                          
    </rules>

</rules>
